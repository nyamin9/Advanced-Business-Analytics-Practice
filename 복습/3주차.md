---
title: "Untitled"
author: "Kang mingu"
date: '2023 4 7 '
output: github_document
---  

<br>  

# ì˜¤ì°¨ì˜ ìê¸°ìƒê´€ í•´ê²°  

<br>  

ì˜¤ì°¨ì˜ ìê¸°ìƒê´€ í•´ê²°ì„ ìœ„í•´ ì°¨ë¶„ ì§„í–‰  

ì°¨ë¶„ ì´í›„ ëª¨ë¸ì˜ í•´ì„ì´ ì•„ì˜ˆ ë°”ë€Œê²Œ ë¨  

ìê¸°ìƒê´€ í•´ê²°ì„ ìœ„í•œ ê°€ì¥ í™•ì‹¤í•œ ë°©ë²•  

<br>  


ê³„ì ˆì˜ ê²½ìš° 1ì°¨ ì°¨ë¶„ì´ ì•„ë‹Œ 12ì°¨ ì°¨ë¶„ì„ í•˜ê¸°ë„ í•¨  

ë˜ëŠ” 12ì°¨ì™€ 1ì°¨ë¥¼ ê°™ì´ ì“°ê¸°ë„ í•¨ -> 1ì°¨ ê³„ì ˆì°¨ë¶„  

12ì°¨ ì°¨ë¶„ í•˜ê¸° ì‹«ìœ¼ë©´ ê³„ì ˆì¡°ì •í•´ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¬ ê²ƒ  

<br>  


ì°¨ë¶„ë§Œ í•œ ê²½ìš° í•´ì„: Yë³€ìˆ˜ì˜ ì „ ì‹œì  ëŒ€ë¹„ ë³€í™”ëŸ‰ (ì›ë˜ Yë³€ìˆ˜ì˜ ë‹¨ìœ„ ìœ ì§€)  

<br>  


log ë³€í™˜ : ë¶„ì‚°ì´ ì»¤ì ¸ì„œ ë“±ë¶„ì‚°ì„± ê°€ì •ì„ ë§Œì¡±í•˜ì§€ ì•ŠëŠ” ê²½ìš° ì‚¬ìš©. ì¦ê°€ìœ¨(%)ë¡œ í•´ì„.  

log log ë³€í™˜ : ì¦ê°€ìœ¨ì˜ ì¦ê°€ìœ¨ -> %ì˜ ì¦ê°€ìœ¨. %p ë‹¨ìœ„.  

<br>  


Log & ì°¨ë¶„: Yë³€ìˆ˜ì˜ ì „ ì‹œì  ëŒ€ë¹„ ë³€í™”ìœ¨ (ë‹¨ìœ„ ìœ ì§€ ì•ˆë¨, %ë¡œ ë³€í™˜ê°€ëŠ¥(Ã—100))  

Yë³€ìˆ˜ê°€ ê¸ˆìœµìƒí’ˆì˜ ê°€ê²©ì´ë¼ë©´ ìˆ˜ìµë¥  (ë¡œê·¸ ìˆ˜ìµë¥ ì´ë¼ê³  ë¶€ë¥´ê¸°ë„ í•¨)ë¡œ í•´ì„ê°€ëŠ¥  

CAPM, FAMA-FRENCH  

<br>  


ë³´í†µ ëˆê³¼ ê´€ë ¨ëœ ê²½ì œ ê²½ì˜ ë³€ìˆ˜ë“¤ì€ log ì°¨ë¶„ì„ ì·¨í•˜ëŠ” ê²½ìš°ê°€ ë§ìŒ  


ì°¨ë¶„ì„ í•˜ì§€ ì•Šê³  ìê¸°ìƒê´€ì„ í•´ê²°í•˜ë ¤ë©´ ì‹œê³„ì—´ ëª¨í˜•ì„ ì‚¬ìš©í•´ì•¼í•¨  


<br>  


ì‹œê³„ì—´ ìë£Œì˜ ì•ˆì •ì„± (Stationary process)  

Stationarityì—ëŠ” ë“±ë¶„ì‚°ì„±, ìê¸°ìƒê´€ì„±ì´ í¬í•¨ë¨  

ì´ë¥¼ ë§Œì¡±í•˜ëŠ” ê²½ìš°ì—ë§Œ ì‹œê³„ì—´ ëª¨í˜• ì‚¬ìš©ì´ ê°€ëŠ¥í•¨  

<br>  

***  

<br>  

## 1ì°¨ì°¨ë¶„  

<br>  

ì°¨ë¶„í•˜ê³  ë‚˜ë©´ ì°¨ë¶„ ì „ì˜ íŠ¸ë Œë“œë¥¼ ì—†ì• ì¤Œ  

ì´ ê²½ìš° ì‹œê°„ì— ë”°ë¼ ì¦ê°€í•˜ëŠ” íŠ¸ë Œë“œë¥¼ ì—†ì• ì£¼ëŠ” ê²ƒ  

<br>  

### ë°ì´í„° í™•ì¸  

<br>  


```{r}
df1 <- read.csv("C:\\Users\\yamingu\\Desktop\\ê³ ê¸‰ë¹„ì¦ˆë‹ˆìŠ¤ì–´ë‚¼ë¦¬í‹±ìŠ¤\\[Ch2.ì‹œê³„ì—´íšŒê·€ë¶„ì„]_files\\Table6_1.csv")
summary(df1)
```
```
>>

     year       consumption         income         wealth         interest        
 Min.   :1947   Min.   : 976.4   Min.   :1035   Min.   : 5167   Min.   :-10.35094  
 1st Qu.:1960   1st Qu.:1518.4   1st Qu.:1679   1st Qu.: 8507   1st Qu.: -0.07559  
 Median :1974   Median :2664.8   Median :3062   Median :12858   Median :  1.46251  
 Mean   :1974   Mean   :2888.4   Mean   :3215   Mean   :15439   Mean   :  1.21197  
 3rd Qu.:1987   3rd Qu.:4080.3   3rd Qu.:4559   3rd Qu.:21059   3rd Qu.:  3.11080  
 Max.   :2000   Max.   :6257.8   Max.   :6539   Max.   :39591   Max.   :  5.84833  
                                                                                   
   lnconsump         lndpi          lnwealth        dlnconsump            dlndpi         
 Min.   :6.884   Min.   :6.942   Min.   : 8.550   Min.   :-0.008331   Min.   :-0.006662  
 1st Qu.:7.325   1st Qu.:7.426   1st Qu.: 9.048   1st Qu.: 0.024172   1st Qu.: 0.024460  
 Median :7.888   Median :8.027   Median : 9.462   Median : 0.034971   Median : 0.031922  
 Mean   :7.826   Mean   :7.935   Mean   : 9.493   Mean   : 0.035051   Mean   : 0.034778  
 3rd Qu.:8.314   3rd Qu.:8.425   3rd Qu.: 9.955   3rd Qu.: 0.048197   3rd Qu.: 0.045919  
 Max.   :8.742   Max.   :8.786   Max.   :10.586   Max.   : 0.069925   Max.   : 0.084918  
                                                  NA's   :1           NA's   :1          
   dlnwealth          dinterest         rlnconsump        rlndpi        rlnwealth    
 Min.   :-0.09725   Min.   :-5.6905   Min.   :4.671   Min.   :4.728   Min.   :5.796  
 1st Qu.: 0.01980   1st Qu.:-0.6367   1st Qu.:4.964   1st Qu.:5.042   1st Qu.:6.160  
 Median : 0.03993   Median : 0.0368   Median :5.345   Median :5.437   Median :6.398  
 Mean   : 0.03773   Mean   : 0.2628   Mean   :5.309   Mean   :5.382   Mean   :6.435  
 3rd Qu.: 0.06306   3rd Qu.: 0.8381   3rd Qu.:5.631   3rd Qu.:5.700   3rd Qu.:6.740  
 Max.   : 0.10663   Max.   : 5.7639   Max.   :5.919   Max.   :5.944   Max.   :7.184  
 NA's   :1          NA's   :1         NA's   :1       NA's   :1       NA's   :1      
   rinterest         dconsump         dincome         dwealth           rconsump     
 Min.   :-5.415   Min.   :-22.20   Min.   :-20.4   Min.   :-1423.5   Min.   : 704.4  
 1st Qu.: 0.307   1st Qu.: 40.10   1st Qu.: 56.6   1st Qu.:  152.2   1st Qu.:1086.7  
 Median : 1.359   Median : 87.70   Median :101.1   Median :  554.7   Median :1908.6  
 Mean   : 1.051   Mean   : 99.65   Mean   :103.8   Mean   :  622.7   Mean   :2074.6  
 3rd Qu.: 2.193   3rd Qu.:147.50   3rd Qu.:135.9   3rd Qu.:  822.4   3rd Qu.:2915.7  
 Max.   : 4.325   Max.   :289.40   Max.   :314.1   Max.   : 4004.2   Max.   :4462.2  
 NA's   :1        NA's   :1        NA's   :1       NA's   :1         NA's   :1       
    rincome          rwealth        rinterest2           time      
 Min.   : 767.7   Min.   : 3726   Min.   :-5.4057   Min.   : 1.00  
 1st Qu.:1219.2   1st Qu.: 6392   1st Qu.: 0.3217   1st Qu.:14.25  
 Median :2190.4   Median : 9064   Median : 1.3850   Median :27.50  
 Mean   :2308.1   Mean   :11117   Mean   : 1.0789   Mean   :27.50  
 3rd Qu.:3232.7   3rd Qu.:15059   3rd Qu.: 2.2960   3rd Qu.:40.75  
 Max.   :4637.9   Max.   :28885   Max.   : 4.4371   Max.   :54.00  
 NA's   :1        NA's   :1       NA's   :1  
```  

<br>  

```{r}
## ì‚¬ìš©í•  ë¶€ë¶„ë§Œ tsë°ì´í„°ë¡œ ë³€ê²½
## ë…„ë„ë³„ ë°ì´í„°
df1.ts <- ts(df1[, 2:8], start = 1947, frequency = 1)
head(df1.ts)
is.ts(df1.ts)
```  
```
>>

     consumption income   wealth   interest lnconsump    lndpi lnwealth
[1,]       976.4 1035.2 5166.815 -10.350940  6.883873 6.942350 8.550012
[2,]       998.1 1090.0 5280.757  -4.719804  6.905853 6.993933 8.571825
[3,]      1025.3 1095.6 5607.351   1.044063  6.932741 6.999057 8.631834
[4,]      1090.9 1192.7 5759.515   0.407346  6.994758 7.083975 8.658608
[5,]      1107.1 1227.0 6086.056  -5.283152  7.009499 7.112328 8.713756
[6,]      1142.4 1266.8 6243.864  -0.277011  7.040886 7.144249 8.739354


>> [1] TRUE
```  


<br>  

```{r}  
## ê° featureë“¤ì˜ plot ë¨¼ì € ì‚´í´ë³¼ê²ƒ!!
plot(df1.ts,col="red")
```  

![image](https://user-images.githubusercontent.com/65170165/230622212-82bdef16-47ed-4cb9-a80d-3bddd3838f89.png)  

<br>  

```{r}
plot(df1$lnconsump)
```  
![image](https://user-images.githubusercontent.com/65170165/230622267-b76612f3-9a16-4762-ba59-5a468c4c2224.png)


<br>  

### ìê¸°ìƒê´€ íŒŒì•…  

***  

<br>  

#### 1. acf plot  


<br>  

```{r}
par(mfrow=c(2,2))
acf(df1$lnconsump)
acf(df1$lndpi)
acf(df1$lnwealth)
```  
![image](https://user-images.githubusercontent.com/65170165/230622486-3d30378a-2b69-4aa4-9d4f-ca60744b4a81.png)



<br>  


#### 2. ë”ë¹ˆì™“ìŠ¨ê²€ì •  

<br>  

ë‹¨ ì˜¤ì°¨í•­ì˜ 1ì°¨ ìê¸°ìƒê´€ë§Œ ê²€ì •í•¨  

<br>  

```{r}
## ì„¸ feature ëª¨ë‘ ìê¸°ìƒê´€ ì¡´ì¬
library(lmtest)
dwtest(lnconsump~1,data=df1.ts)
dwtest(lndpi~1,data=df1.ts)
dwtest(lnwealth~1,data=df1.ts)
```  
```
>>

Durbin-Watson test

data:  lnconsump ~ 1
DW = 0.00502, p-value < 2.2e-16
alternative hypothesis: true autocorrelation is greater than 0


	Durbin-Watson test

data:  lndpi ~ 1
DW = 0.0050353, p-value < 2.2e-16
alternative hypothesis: true autocorrelation is greater than 0


	Durbin-Watson test

data:  lnwealth ~ 1
DW = 0.009523, p-value < 2.2e-16
alternative hypothesis: true autocorrelation is greater than 0

```  

<br>  

```{r}
library(car)
durbinWatsonTest(lm(lnconsump~1,data=df1.ts),max.lag=3)
```
```
>>

 lag Autocorrelation D-W Statistic p-value
   1       0.9441254   0.005020027       0
   2       0.8880973   0.018101451       0
   3       0.8326139   0.038208817       0
 Alternative hypothesis: rho[lag] != 0
```

<br>  



#### 3.bgtest  

<br>  

ë”ë¹ˆ ì™“ìŠ¨ ê²€ì •ì˜ ë‹¨ì  ë³´ì™„  

<br>  

```{r}
## ì„¸ feature ëª¨ë‘ ìê¸°ìƒê´€ ì¡´ì¬
bgtest(lnconsump~1,data=df1.ts,order=3)
bgtest(lndpi~1,data=df1.ts,order=3)
bgtest(lnwealth~1,data=df1.ts,order=3)
```
```
>>

	Breusch-Godfrey test for serial correlation of order up to 3

data:  lnconsump ~ 1
LM test = 50.823, df = 3, p-value = 5.335e-11


	Breusch-Godfrey test for serial correlation of order up to 3

data:  lndpi ~ 1
LM test = 50.524, df = 3, p-value = 6.179e-11


	Breusch-Godfrey test for serial correlation of order up to 3

data:  lnwealth ~ 1
LM test = 50.627, df = 3, p-value = 5.875e-11
```

<br>  

### ëª¨ë¸í”¼íŒ…  

<br>  

```{r}
model.ts <- lm(lnconsump ~ lndpi + lnwealth + interest, data = df1.ts)
summary(model.ts)
```
```
>>

Call:
lm(formula = lnconsump ~ lndpi + lnwealth + interest, data = df1.ts)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.018441 -0.010001  0.000337  0.007038  0.032579 

Coefficients:
              Estimate Std. Error t value Pr(>|t|)    
(Intercept) -0.4677120  0.0427780 -10.933 7.33e-15 ***
lndpi        0.8048728  0.0174978  45.998  < 2e-16 ***
lnwealth     0.2012702  0.0175926  11.441 1.43e-15 ***
interest    -0.0026891  0.0007619  -3.529 0.000905 ***
---
Signif. codes:  0 â€˜***â€™ 0.001 â€˜**â€™ 0.01 â€˜*â€™ 0.05 â€˜.â€™ 0.1 â€˜ â€™ 1

Residual standard error: 0.01193 on 50 degrees of freedom
Multiple R-squared:  0.9996,	Adjusted R-squared:  0.9995 
F-statistic: 3.783e+04 on 3 and 50 DF,  p-value: < 2.2e-16
```

<br>  


### ëª¨ë¸ ìê¸°ìƒê´€ ì²´í¬  

<br>  

```{r}
par(mfrow = c(1,1))
plot(model.ts$residuals, type = 'b')
```
![image](https://user-images.githubusercontent.com/65170165/230622865-9a1481bf-edff-4598-b23a-8468fbcf04a6.png)  

<br>  

```{r}
acf(model.ts$residuals)
```  
![image](https://user-images.githubusercontent.com/65170165/230623027-7f9c2331-d062-48ab-81b2-50dfd5e8c8a1.png)  

<br>  

```{r}
dwtest(model.ts)
```  
```
>>

	Durbin-Watson test

data:  model.ts
DW = 1.2892, p-value = 0.0009445
alternative hypothesis: true autocorrelation is greater than 0
```
<br>  

```{r}
durbinWatsonTest(model.ts, max.lag = 3)
```
```
>>

 lag Autocorrelation D-W Statistic p-value
   1      0.29775555      1.289232   0.010
   2     -0.02840612      1.933710   0.694
   3      0.01631809      1.678649   0.218
 Alternative hypothesis: rho[lag] != 0
```  

<br>  

```{r}
bgtest(model.ts, order = 1)
bgtest(model.ts, order = 3)
```  
```
>>

	Breusch-Godfrey test for serial correlation of order up to 1

data:  model.ts
LM test = 5.312, df = 1, p-value = 0.02118


	Breusch-Godfrey test for serial correlation of order up to 3

data:  model.ts
LM test = 6.6573, df = 3, p-value = 0.08366
```

<br>  


### ì°¨ë¶„  

<br>  

```{r}
ynew <- diff(df1$lnconsump, difference = 1)
lndpinew <- diff(df1$lndpi, difference = 1)
lnwealthnew <- diff(df1$lnwealth, difference = 1)
interestnew <- diff(df1$interest, difference = 1)

## ëª¨ë¸ìƒì„±
model.ts2 <- lm(ynew ~ lndpinew + lnwealthnew + interestnew)
summary(model.ts2)

model.ts2 <- lm(ynew ~ lndpinew + lnwealthnew)
summary(model.ts2)

plot(model.ts2$residuals, type = 'b')
acf(model.ts2$residuals)

library(lmtest)
dwtest(model.ts3)

bgtest(model.ts3, order = 1)
bgtest(model.ts3, order = 3)

library(car)
durbinWatsonTest(model.ts3, max.lag = 1)
durbinWatsonTest(model.ts3, max.lag = 3)
```

<br>  

5ë²ˆ ê°€ì •ì€ í•´ê²°í–ˆì§€ë§Œ, ë°ì´í„°ì— ë¡œê·¸ë³€í™˜ê³¼ ì°¨ë¶„ì„ ì·¨í–ˆê¸°ì— ì™„ì „íˆ ë‹¤ë¥¸ ë°ì´í„°ì„  

ë”°ë¼ì„œ, 1ë²ˆ ê°€ì •ë¶€í„° ë‹¤ì‹œ ë´ì•¼ë¨!!  

ì´ì œëŠ” ê°€ì • 6ë²ˆì— ì§‘ì¤‘í•˜ì. ìˆœì„œëŒ€ë¡œ.  

ìƒê´€ê³„ìˆ˜ í™•ì¸.  

ì •ëŸ‰ & ë²”ì£¼í˜• ë³€ìˆ˜ ìƒê´€ê´€ê³„ í™•ì¸ : vif() í•¨ìˆ˜  

<br>  


***  

<br>  

## ì°¨ë¶„ ì™¸ì˜ ìê¸°ìƒê´€ í•´ê²°ë²•  

<br>  

íšŒê¸°ê°€ë³€ìˆ˜ ì‚¬ìš©

<br>  

### íŠ¸ë Œë“œ (trend)  

1ì°¨ìê¸°ìƒê´€ì´ ì‹¬í•˜ê²Œ ìˆëŠ” ê²½ìš°  

Xë³€ìˆ˜ì—ë„ trendê°€ ìˆê¸° ë•Œë¬¸ì— íšŒê·€ëª¨í˜• ì í•©ì„ í†µí•´ ì˜¤ì°¨í•­ì—ëŠ” trendê°€ ë‚¨ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŒ  

ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ trendì— í•´ë‹¹í•˜ëŠ” ê°€ë³€ìˆ˜ë¥¼ Xë³€ìˆ˜ë¡œ ì¶”ê°€ ê°€ëŠ¥.  

íŠ¸ë Œë“œ ê°€ë³€ìˆ˜: time feature, ğ‘¡,ğ‘¡^2 ë“±  

<br>  

```{r}
## ì ì  ì¦ê°€í•˜ëŠ” íŠ¸ë Œë“œ í™•ì¸ ê°€ëŠ¥
plot(df1$lnconsump ~ df1$time)
model.ts3 <- lm(lnconsump ~ lndpi + lnwealth + interest + time, data = df1)
summary(model.ts3)

plot(model.ts3$residuals,type="b")
acf(model.ts3$residuals)

dwtest(model.ts3)
durbinWatsonTest(model.ts,max.lag=3)
durbinWatsonTest(model.ts2,max.lag=3)
durbinWatsonTest(model.ts3,max.lag=3)

bgtest(model.ts3,order=1)
bgtest(model.ts3,order=3)
```  

<br>  


### ê³„ì ˆì„± (seasonality)  

<br>  

12ì°¨ í˜¹ì€ 4ì°¨ ìê¸°ìƒê´€ì´ ì‹¬í•˜ê²Œ ìˆëŠ” ê²½ìš°  

Xë³€ìˆ˜ì—ë„ ê³„ì ˆì„±ì´ ìˆë‹¤ë©´ íšŒê·€ëª¨í˜• ì í•©ì„ í†µí•´ ì˜¤ì°¨í•­ì—ëŠ” ê³„ì ˆì„±ì´ ë‚¨ì§€ ì•Šì„ ìˆ˜ë„ ìˆìŒ  

ê·¸ë ‡ì§€ ì•Šë‹¤ë©´ ê³„ì ˆì„±ì— í•´ë‹¹í•˜ëŠ” ê°€ë³€ìˆ˜ë¥¼ Xë³€ìˆ˜ë¡œ ì¶”ê°€ ê°€ëŠ¥.  

ê³„ì ˆê°€ë³€ìˆ˜: ì›”ë³„ í˜¹ì€ ê³„ì ˆ ë”ë¯¸ ë³€ìˆ˜  

<br>  

```{r}
## ê³„ì ˆì„± ì¡ê¸°
plot(AirPassengers)

## ê³„ì ˆë”ë¯¸ë³€ìˆ˜ month
month<-rep(c(1:12), 12)

# ì‹œê°„ë”ë¯¸ë³€ìˆ˜ time
time<-c(1:length(AirPassengers))

model<-lm(AirPassengers ~ as.factor(month) + time)
summary(model)

acf(model$residuals)
acf(AirPassengers)
```

<br>  

***  

<br>  

## ë¯¸êµ­ì†Œë¹„í•¨ìˆ˜ ë°ì´í„° ë¶„ì„  

<br>  


1973-2011ë…„ê¹Œì§€ì˜ ë°ì´í„°  

2007ë…„ ì„œë¸Œí”„ë¼ì„ëª¨ê¸°ì§€ ì‚¬íƒœë¡œ ì¸í•´ ëš ë–¨ì–´ì§€ëŠ” ë°ì´í„°  

<br>  

- Hstart : ì‹ ê·œì£¼íƒê±´ì„¤, ê³„ì ˆ ì¡°ì •(ë‹¨ìœ„:ì²œ)  

- UN : ê³„ì ˆì¡°ì •ëœ ë¯¼ê°„ ì‹¤ì—…ë¥ (ë‹¨ìœ„: %)  

- M2: ê³„ì ˆì¡°ì •ëœ M2 ê³µê¸‰ëŸ‰(ë‹¨ìœ„:10ì–µë‹¬ëŸ¬)  

- Mgrate: ì‹ ê·œì£¼íƒ ëª¨ê¸°ì§€ë¡  ì´ììœ¨(ë‹¨ìœ„: %)  

- Primerate: ì€í–‰ì˜ í”„ë¼ì„ë ˆì´íŠ¸(ìµœëŒ€ìš°ëŒ€ê¸ˆë¦¬)(ë‹¨ìœ„: %)  

- RGDP: ì‹¤ì§ˆ GDP(2005ë…„ ê¸°ì¤€), ê³„ì ˆì¡°ì •

<br>  

### íƒ€ì„ ë° ë”ë¯¸ ë³€ìˆ˜ ë„£ì–´ë³´ê¸°  

<br>  

```{r}
data <- read.csv("C:\\Users\\yamingu\\Desktop\\ê³ ê¸‰ë¹„ì¦ˆë‹ˆìŠ¤ì–´ë‚¼ë¦¬í‹±ìŠ¤\\[Ch2.ì‹œê³„ì—´íšŒê·€ë¶„ì„]_files\\Table6_10.csv")
head(data)

plot(data$hstart)
```

<br>  

### ëª¨ë¸ í…ŒìŠ¤íŠ¸  

<br>  

```{r}
m <- lm(hstart ~ un + m2 + mgrate + primerate + rgdp, data = data)
summary(m)
plot(m$residuals~m$fitted.values)
abline(h = 0)
acf(m$residuals)
```

<br>  

### ë³€ìˆ˜ ë³€í™˜  

<br>  

```{r}
## log
data$lnhstart <- log(data$hstart) 
data$lnun <- log(data$un) 
data$lnmgrate <- log(data$mgrate)
data$lnprimerate <- log(data$primerate)
data$lnrgdp <- log(data$rgdp)
data$lnm2 <- log(data$m2)

## ì°¨ë¶„
newhstart <- diff(data$hstart, differences = 1)
newun <- diff(data$un, difference = 1)
newmgrate <- diff(data$mgrate, difference = 1)
newprimerate <- diff(data$primerate, differences = 1)
newm2 <- diff(data$m2, differences = 1)
newrgdp <- diff(data$rgdp, differences = 1)
newtime <- diff(data$time2, differences = 1)

## ë¡œê·¸ë³€í™˜ í›„ ì°¨ë¶„
newlnhstart <- diff(data$lnhstart, differences = 1)
newlnun <- diff(data$lnun, difference = 1)
newlnmgrate <- diff(data$lnmgrate, difference = 1)
newlnprimerate <- diff(data$lnprimerate, differences = 1)
newlnm2 <- diff(data$lnm2, differences = 1)
newlnrgdp <- diff(data$lnrgdp, differences = 1)
```  

<br>  



### ëª¨ë¸í”¼íŒ…  

<br>  

```{r}
m3 <- lm(newlnhstart ~ newm2 + newrgdp + newprimerate -1)
summary(m3)

plot(m3$residuals~m3$fitted.values)
abline(h = 0)

acf(m3$residuals)
dwtest(m3)

cor(newm2,newrgdp)
cor(newm2,newprimerate)
cor(newrgdp,newprimerate)
```

<br>  


### time íŠ¸ë Œë“œ ë³€ìˆ˜  

<br>  

```{r}
## t
data$time<-c(1:length(data$hstart))
## t^2
data$time2<-c(1:length(data$hstart))^2

m4 <- lm(hstart ~ un + mgrate + primerate + time2 + time, data = data)
summary(m4)
acf(m4$residuals)
```

<br>  


### ë°ì´í„° êµ¬ì¡° ë³€ê²½  

<br>  

```{r}
## structural change in HSTART 
## 2007ë…„ ì´ì „ / ì´í›„ì— ëŒ€í•œ ë”ë¯¸ ë³€ìˆ˜ ìƒì„±
## 2007ë…„ -> ì„œë¸Œí”„ë¼ì„ëª¨ê¸°ì§€ì— ì˜í•œ ê¸ˆìœµìœ„ê¸°
dd<-data$year
dd<-ifelse(data$year >= 2007, 1, 0)
data$GFC = dd

m5 <- lm(hstart~ un + mgrate + primerate + GFC, data = data)
summary(m5)
acf(m5$residuals)
```

<br>  


### íƒ€ì„íŠ¸ë Œë“œ / ë²”ì£¼í˜• ë”ë¯¸ë³€ìˆ˜ ì¶”ê°€  

<br>  

```{r}
## ìê¸°ìƒê´€ í•´ê²°
m6 <- lm(hstart ~ un + mgrate + primerate + time2 + time + GFC, data = data)
summary(m6)
acf(m6$residuals)
```  

<br>  

***  

<br>  

# ì‹œê³„ì—´ ë¶„ì„ ëª¨í˜• - ì˜¤ì°¨ì˜ ìê¸°ìƒê´€ í•´ê²°ë°©ë²•  

<br>  

## 1. ë³€ìˆ˜ë³€í™˜ & íšŒê·€ë¶„ì„  

<br>  

## 2. íšŒê·€ ê°€ë³€ìˆ˜ë¥¼ ì´ìš©í•œ íšŒê·€ëª¨í˜•  

<br>  

## 3. ì‹œê³„ì—´ ëª¨í˜• : ì„ í˜•íšŒê·€ëª¨í˜•ì˜ í˜•íƒœ : ì‹œê°„ì´ ë‹¤ë¥¸ ë³€ìˆ˜ê°’(ê³¼ê±°ê°’)ì„ ì‚¬ìš©í•œë‹¤ëŠ” ì ì—ì„œ ë‹¤ë¦„  

<br>  

a. ìê¸° íšŒê·€ ëª¨í˜• (Autoregressive, AR model) : y ë³€ìˆ˜, xë³€ìˆ˜ë„ ê³¼ê±°ì˜ yê°’. ì„ í˜•íšŒê·€ëª¨í˜•.  

b. ìê¸° íšŒê·€ ì‹œì°¨ ë¶„í¬ ëª¨í˜•(Autoregressive Distributed Lag â€“ARDL) : yë³€ìˆ˜, xë³€ìˆ˜ì™€ ê³¼ê±°ì˜ xê°’, ê³¼ê±°ì˜ yê°’. ì„ í˜•íšŒê·€ëª¨í˜•.  

c. ìê¸° ìƒê´€ ì˜¤ì°¨ íšŒê·€ ëª¨í˜•(Regression model with autoregressive error)  

d. ê·¸ ì™¸ ì‹œê³„ì—´ ëª¨í˜• (Moving average (MA), ARMA, ARIMA)  

<br>  

## 4. íšŒê·€ëª¨í˜•ì—ì„œ íšŒê·€ê³„ìˆ˜ì˜ ì¶”ì •ë°©ë²•ì„ ë°”ê¾¸ëŠ” ë°©ë²•  

<br>  

***  

<br>  

# ì‹œê³„ì—´ ëª¨í˜•ì„ ìœ„í•œ ê°€ì •  

<br>  

ì•ˆì •ì  ì‹œê³„ì—´ : Stationary Condition (ì •ìƒì„± ì¡°ê±´)  

ìœ„ 3ì˜ ë°©ë²• ì‚¬ìš© ê°€ëŠ¥. ì•ˆì •ì ì´ì§€ ì•Šìœ¼ë©´ ëª»ì”€  

<br>  

í‰ê· ì´ í•´ë‹¹ê¸°ê°„ ë™ì•ˆ ì¼ì • -> ë¡œê·¸ë³€í™˜  

ë¶„ì‚°ì´ í•´ë‹¹ê¸°ê°„ ë™ì•ˆ ì¼ì • -> ì°¨ë¶„  

<br>  

ê³µë¶„ì‚° í˜¹ì€ ìê¸°ìƒê´€ì€ ì‹œì°¨ì—ë§Œ ì˜ì¡´í•¨.  

ì¦‰, ì–´ë””ì„œ ì¸¡ì •í•˜ë”ë¼ë„ 1ë…„ ì „ ì–´ì œì™€ ì˜¤ëŠ˜ê³¼ì˜ ìê¸°ìƒê´€ì´ í˜„ì¬ì˜ ìê¸°ìƒê´€ê³¼ ê°™ì•„ì•¼ í•¨.  

ë°ì´í„° ë¶„í• !!  

<br>  

ìœ„ì˜ ê°€ì •ì„ ë§Œì¡±í•˜ì§€ ëª»í•˜ëŠ” ê²½ìš°ì—ëŠ” ë³€ìˆ˜ë³€í™˜ (ë¡œê·¸, ì°¨ë¶„)ì„ í†µí•´ ì •ìƒì‹œê³„ì—´ë¡œ ë§Œë“¬  

ì˜¬ë¼ê°€ëŠ” íŠ¸ë Œë“œì˜ ê²½ìš° 1ì°¨ ì°¨ë¶„ì„ í†µí•´ ë–¨ì–´ì§€ê²Œ ë§Œë“¤ ìˆ˜ ìˆìŒ  

í•˜ì§€ë§Œ ì»¤ì§ê³¼ ì‘ì•„ì§ì„ ë°˜ë³µí•˜ëŠ” ê²½ìš°ê°€ ë§ìŒ -> ë¶„ì‚°ì— ëŒ€í•œ ëª¨ë¸ë§ í•„ìš”  

<br>  



## 1. AR(p)  

<br>  

p-ì°¨ ìê¸° íšŒê·€ëª¨í˜•  

ë…ë¦½ë³€ìˆ˜ë¡œ ì¢…ì†ë³€ìˆ˜ì˜ pì‹œì  ì´ì „ê¹Œì§€ ëª¨ë“  ê³¼ê±°ê°’ì„ ê³ ë ¤í•œ ARëª¨í˜•  

í•˜ì§€ë§Œ OLS ì‚¬ìš©ì„ í•˜ê¸°ì—ëŠ” xê°’ì´ ì£¼ì–´ì ¸ìˆë‹¤ëŠ” ê°€ì •ì— ë¬¸ì œê°€ ë  ìˆ˜ ìˆìŒ. ê·¸ë˜ë„ ì“´ë‹¤.  

<br>  



## 2. ìê¸°íšŒê·€ ì‹œì°¨ë¶„í¬ ëª¨í˜• (Autoregressive Distributed Lag, AR DL model)  

<br>  

ë…ë¦½ë³€ìˆ˜ë¡œ ì¢…ì†ë³€ìˆ˜ì˜ ê³¼ê±°ê°’ (ğ‘¦ğ‘¡âˆ’1)ê·¸ë¦¬ê³  ë‹¤ë¥¸ ë…ë¦½ë³€ìˆ˜ (ğ‘¥ğ‘¡) ë“¤ì„ ì‚¬ìš©  

ë…ë¦½ë³€ìˆ˜ë¡œ ì¢…ì†ë³€ìˆ˜ì˜ ê³¼ê±°ê°’ (ğ‘¦ğ‘¡âˆ’1), ë…ë¦½ë³€ìˆ˜ (ğ‘¥ğ‘¡), ë…ë¦½ë³€ìˆ˜ì˜ ê³¼ê±°ê°’ (ğ‘¥ğ‘¡âˆ’1) ì„ ì‚¬ìš©  

<br>  


## 3. ìê¸°ìƒê´€ì˜¤ì°¨ íšŒê·€ëª¨í˜•  

<br>  

íšŒê·€ëª¨í˜•ì€ ë…ë¦½ë³€ìˆ˜ë¡œ X (ğ‘¥ğ‘¡) ë§Œ ì‚¬ìš©í•˜ì—¬ Fit  

ì˜¤ì°¨í•­ì˜ ìê¸°ìƒê´€ì€ ì˜¤ì°¨í•­ì˜ ARëª¨í˜•ìœ¼ë¡œ ë”°ë¡œ ì í•©  

ì¦‰, ëª¨ë¸ì´ ë‘ê°œ  

<br>  


ìµœì†Œì œê³±ì¶”ì •ë°©ë²•(OLS)ë¥¼ ì´ìš©í•  ìˆ˜ ìˆë‹¤.  

ê·¸ëŸ¬ë‚˜ ì¢…ì†ë³€ìˆ˜ì˜ ê³¼ê±°ì¹˜ê°€ ë…ë¦½ë³€ìˆ˜ë¡œ ê³ ë ¤ë˜ëŠ” ARëª¨í˜•ì˜ ê²½ìš°, OLS ì¶”ì •ëŸ‰ì´ ì—¬ì „íˆ ì¢‹ì€ ì„±ì§ˆì„ ê°€ì§€ê³  ìˆìœ¼ë‚˜ ëª¨í˜•ì„ í†µí•œ ì˜ˆì¸¡ì¹˜ì˜ ì‹ ë¢°êµ¬ê°„ì´ ë” ì‘ê²Œ êµ¬í•´ì§ˆ ìˆ˜ ìˆëŠ” ë‹¤ë¥¸ ì¶”ì •ë°©ë²•ì´ ìˆìŒ.  

<br>  

ARëª¨í˜•ì˜ ê²½ìš° MLE (Maximum Likelihood Estimation), CSS-ML(conditional sum of squared MLE).  


ìê¸°ìƒê´€ ì˜¤ì°¨ íšŒê·€ëª¨í˜•ì˜ ê²½ìš° Cochrane-Orcutt Estimation ë“±ì˜ ë°©ë²•ì„ ì´ìš©  

<br>  

***  
