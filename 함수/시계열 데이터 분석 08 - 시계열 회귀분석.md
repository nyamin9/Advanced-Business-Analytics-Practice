# ğŸ•‘ ì‹œê³„ì—´ íšŒê·€ë¶„ì„  

<br>  

ì„œë¡œ ë‹¤ë¥¸ ê°œì²´ ê°„ ì˜¤ì°¨í•­ë“¤ì€ ì„œë¡œ ìê¸°ìƒê´€ì´ ì—†ë‹¤ëŠ” ê°€ì •ì˜ ì˜í–¥ì„ ê³ ë ¤í•´ì¤˜ì•¼ í•©ë‹ˆë‹¤.  

íŠ¹íˆ ì‹œê³„ì—´ ë°ì´í„°ì˜ íŠ¹ì„± ìƒ, ê° ê°œì²´ ê°„ ìê¸°ìƒê´€ì´ ì—†ì„ ìˆ˜ ì—†ê¸° ë•Œë¬¸ì— ê¼­ ì´ì— ëŒ€í•œ ì²˜ë¦¬ë¥¼ í•´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤.  

ëŒ€í‘œì ìœ¼ë¡œ, ì°¨ë¶„ì„ ì§„í–‰í•´ì„œ 1ì°¨ ìê¸°ìƒê´€ì„ ì¤„ì´ëŠ” ë°©ë²•ì´ ìˆê² ìŠµë‹ˆë‹¤.  

<br>  

<br>  

## ğŸ•‘ ì„ í˜•íšŒê·€ : `lm(Y ~ X1 + X2 + X3, data = DATA)`  

<br>  

### ğŸ•‘ ë¨¼ì €, ì¼ë°˜ ë°ì´í„°í”„ë ˆì„ì— ëŒ€í•´ íšŒê·€ë¶„ì„ì„ ì§„í–‰í•˜ê² ìŠµë‹ˆë‹¤.  

<br>  

``` r
## ë°ì´í„°í”„ë ˆì„
head(df1)
```

    ##    year consumption income    wealth   interest lnconsump    lndpi  lnwealth
    ## 1  1947       976.4 1035.2  5166.815 -10.350940  6.883873 6.942350  8.550012
    ## 2  1948       998.1 1090.0  5280.757  -4.719804  6.905853 6.993933  8.571825
    ## 3  1949      1025.3 1095.6  5607.351   1.044063  6.932741 6.999057  8.631834
    ## 4  1950      1090.9 1192.7  5759.515   0.407346  6.994758 7.083975  8.658608
    ## 5  1951      1107.1 1227.0  6086.056  -5.283152  7.009499 7.112328  8.713756
    
    ##      dlnconsump       dlndpi     dlnwealth   dinterest rlnconsump   rlndpi
    ## 1            NA           NA            NA          NA         NA       NA
    ## 2   0.021980762  0.051583290  2.181339e-02  5.63113594   4.670862 4.739956
    ## 3   0.026887417  0.005124092  6.000900e-02  5.76386690   4.690612 4.728332
    ## 4   0.062017441  0.084917545  2.677441e-02 -0.63671696   4.743900 4.811586
    ## 5   0.014740944  0.028352737  5.514717e-02 -5.69049835   4.738506 4.812368
    
    ##    rlnwealth   rinterest   dconsump    dincome       dwealth  rconsump
    ## 1         NA          NA         NA         NA            NA        NA
    ## 2   5.795887 -1.35915709  21.699951  54.800049  1.139419e+02  704.3560
    ## 3   5.848814  2.57644486  27.200073   5.599976  3.265942e+02  725.0278
    ## 4   5.856105  0.06836937  65.599976  97.099976  1.521641e+02  782.4448
    ## 5   5.902559 -5.41540527  16.199951  34.300049  3.265410e+02  778.9094
    
    ##      rincome   rwealth  rinterest2 time
    ## 1         NA        NA          NA    1
    ## 2   778.5664  3726.352 -1.60578680    2
    ## 3   767.6801  4018.668  2.46398711    3
    ## 4   863.0954  4072.578  0.09324604    4
    ## 5   868.1835  4353.341 -5.40569973    5  
    
<br>  

``` r
class(df1)
```

    ## [1] "data.frame"  
     

<br>  

``` r
model1 <- lm(lnconsump ~ lndpi + lnwealth + interest, data = df1)
summary(model1)
```

    ## 
    ## Call:
    ## lm(formula = lnconsump ~ lndpi + lnwealth + interest, data = df1)
    ## 
    ## Residuals:
    ##       Min        1Q    Median        3Q       Max 
    ## -0.018441 -0.010001  0.000337  0.007038  0.032579 
    ## 
    ## Coefficients:
    ##               Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) -0.4677120  0.0427780 -10.933 7.33e-15 ***
    ## lndpi        0.8048728  0.0174978  45.998  < 2e-16 ***
    ## lnwealth     0.2012702  0.0175926  11.441 1.43e-15 ***
    ## interest    -0.0026891  0.0007619  -3.529 0.000905 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 0.01193 on 50 degrees of freedom
    ## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9995 
    ## F-statistic: 3.783e+04 on 3 and 50 DF,  p-value: < 2.2e-16  
    
<br>  

<br>  

### ğŸ•‘ ì´ë²ˆì—ëŠ”, ts ë°ì´í„°ë¡œ ë³€í™˜í•´ì„œ íšŒê·€ë¶„ì„ì„ ì§„í–‰í•˜ê°°ìŠµë‹ˆë‹¤.  

<br>  

ì„¸ë¶€ì ìœ¼ë¡œ ë°ì´í„°ì˜ ìš”ì¸ì„ íŒŒì•…í•˜ê³  ì´ë¥¼ ê³ ë ¤í•œ ë¶„ì„ì„ ì§„í–‰í•´ ë³´ê² ìŠµë‹ˆë‹¤.  

<br>  

``` r
## ts ë°ì´í„°ë¡œ ë³€í™˜
df1.ts <- ts(df1[, 2:8], start = 1947, frequency = 1)
head(df1.ts)
```
    ## Time Series:
    ## Start = 1947 
    ## End = 2000 
    ## Frequency = 1 
    ##      consumption income    wealth   interest lnconsump    lndpi  lnwealth
    ## 1947       976.4 1035.2  5166.815 -10.350940  6.883873 6.942350  8.550012
    ## 1948       998.1 1090.0  5280.757  -4.719804  6.905853 6.993933  8.571825
    ## 1949      1025.3 1095.6  5607.351   1.044063  6.932741 6.999057  8.631834
    ## 1950      1090.9 1192.7  5759.515   0.407346  6.994758 7.083975  8.658608
    ## 1951      1107.1 1227.0  6086.056  -5.283152  7.009499 7.112328  8.713756 
    
<br>  

``` r
is.ts(df1.ts)
```
    ## [1] TRUE  
    
<br>  

ê°€ì¥ ë¨¼ì € í™•ì¸í•´ì•¼ í•˜ëŠ” plotì€ time plotì…ë‹ˆë‹¤!!  

time plotì—ì„œ í™•ì¸í•  ì ì€ ê¸± ë³€ìˆ˜ì˜ íŠ¸ë Œë“œ, ê³„ì ˆì„±, íˆ­ ë–¨ì–´ì¡Œë‹¤ê°€ ì˜¬ë¼ê°€ëŠ” ë¶€ë¶„ì´ ìˆëŠ”ì§€ì˜ ì—¬ë¶€ì…ë‹ˆë‹¤.  

<br>  

- ë§Œì•½ ë–¨ì–´ì§„ ë¶€ë¶„ì´ ìˆìœ¼ë©´ ì´ìœ ë¥¼ íŒŒì•…í•˜ê³  ì œëŒ€ë¡œ ëœ ë°ì´í„°ì¸ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.  

- ë˜í•œ ì›”ë³„ ë°ì´í„°ì¸ë°ë„ seasonalityê°€ ì—†ë‹¤ë©´ ê³„ì ˆì¡°ì •ì´ ëœ ë°ì´í„°ì¸ì§€ ë°˜ë“œì‹œ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤.  
   
- ì–´ëŠ columnì—ëŠ” ê³„ì ˆì„±ì´ ìˆê³ , ë‹¤ë¥¸ columnì—ëŠ” ì—†ìœ¼ë©´ ì´ ë°ì´í„°ëŠ” ì“°ë©´ ì•ˆë©ë‹ˆë‹¤. í˜¹ì€ ì‚¬ìš©í•  ë¶€ë¶„ë§Œ ì‚¬ìš©í•©ì‹œë‹¤.  
   
<br>  

``` r
plot(df1.ts, col = 'red')
```  

![image](https://user-images.githubusercontent.com/65170165/227722900-b24a8e48-2bc5-49e8-a195-7a2e314c752e.png)  

<br>  

plot ê²°ê³¼, ì „ë°˜ì ì¸ ë°ì´í„°ì˜ íŠ¸ë Œë“œê°€ í•¨ê»˜ ì›€ì§ì´ê³  ìˆìŠµë‹ˆë‹¤.  

ë˜í•œ ë…„ë„ë³„ ë°ì´í„°ì´ë¯€ë¡œ ëˆˆì— í™• ë„ëŠ” seasonalityëŠ” ì—†ìŠµë‹ˆë‹¤.  

<br>  

``` r
model.ts <- lm(lnconsump ~ lndpi + lnwealth + interest, data = df1.ts)
summary(model.ts)
```
    ## 
    ## Call:
    ## lm(formula = lnconsump ~ lndpi + lnwealth + interest, data = df1.ts)
    ## 
    ## Residuals:
    ##       Min        1Q    Median        3Q       Max 
    ## -0.018441 -0.010001  0.000337  0.007038  0.032579 
    ## 
    ## Coefficients:
    ##               Estimate Std. Error t value Pr(>|t|)    
    ## (Intercept) -0.4677120  0.0427780 -10.933 7.33e-15 ***
    ## lndpi        0.8048728  0.0174978  45.998  < 2e-16 ***
    ## lnwealth     0.2012702  0.0175926  11.441 1.43e-15 ***
    ## interest    -0.0026891  0.0007619  -3.529 0.000905 ***
    ## ---
    ## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
    ## 
    ## Residual standard error: 0.01193 on 50 degrees of freedom
    ## Multiple R-squared:  0.9996, Adjusted R-squared:  0.9995 
    ## F-statistic: 3.783e+04 on 3 and 50 DF,  p-value: < 2.2e-16  
    
<br>  

R-square ê°’ì´ êµ‰ì¥íˆ ë†’ì§€ë§Œ, íŠ¸ë Œë“œê°€ ì´ìœ ì¼ ìˆ˜ ìˆìœ¼ë¯€ë¡œ ì˜ëª»ëœ ê°’ì¼ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.  

í•´ë‹¹ ëª¨í˜•ì„ ì‚¬ìš©í•˜ë ¤ë©´ ëª‡ ê°€ì§€ ì¥ê¸° ê· í˜• ê´€ê³„ì— ëŒ€í•œ í…ŒìŠ¤íŠ¸ë¥¼ ê±°ì³ì•¼ í•©ë‹ˆë‹¤.  

<br>  

ëª¨ë¸ í‰ê°€ë¥¼ ìœ„í•´ì„œ residual plotì„ ê·¸ë ¤ë³´ì•˜ìŠµë‹ˆë‹¤.  

<br>  

``` r
library(lmtest)
plot(model.ts$residuals, type = 'b')
```

![image](https://user-images.githubusercontent.com/65170165/227722973-951af462-b548-45d3-acc7-f17eb912b644.png)  
 

<br>  

<br>  

## ğŸ•‘ ì˜¤ì°¨í•­ì˜ ìê¸°ìƒê´€ íŒŒì•…  

<br>  

ëª¨ë¸ì˜ ìê¸°ìƒê´€ ì°¨ìˆ˜ íŒŒì•… : `acf(MODEL$residuals)`  

<br>  

ë”ë¹ˆì™“ìŠ¨ í…ŒìŠ¤íŠ¸ : `dwtest(MODEL)` `durbinWatsonTest(MODEL, max.lag)`  

<br>  

bg í…ŒìŠ¤íŠ¸ : `bgtest(MODEL, order)`  

<br>  


ë‘ í…ŒìŠ¤íŠ¸ì˜ ê·€ë¬´ê°€ì„¤ì€ ìê¸°ìƒê´€ì´ ì—†ë‹¤ëŠ” ê²ƒì´ë¯€ë¡œ, ë§Œì•½ p-value ê°€ ìœ ì˜ìˆ˜ì¤€ë³´ë‹¤ ì‘ë‹¤ë©´ í•´ë‹¹ ëª¨ë¸ì— ì´ìƒì´ ìˆë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤.  


<br>  

â˜‘ï¸ `acf`  

``` r
acf(model.ts$residuals)
```

![image](https://user-images.githubusercontent.com/65170165/227722960-fc3648e0-aca0-441f-9097-b0a4c4e075da.png)  

<br>  

â˜‘ï¸ `dwtest`  

``` r
## ì”ì°¨ì˜ ìê¸°ìƒê´€ ê²€ì • : dwtest
## p-valueê°€ 0.05ë³´ë‹¤ ì‘ìŒ -> ê·€ë¬´ê°€ì„¤ ê¸°ê°
## ë¬¸ì œê°€ ì—†ë‹¤, ìê¸°ìƒê´€ì´ ì—†ë‹¤ëŠ” ê²ƒì´ ê·€ë¬´ê°€ì„¤ì´ë¯€ë¡œ í•´ë‹¹ ëª¨ë¸ì€ ë¬¸ì œê°€ ìˆëŠ” ëª¨ë¸ì„
dwtest(model.ts)
```

    ## 
    ##  Durbin-Watson test
    ## 
    ## data:  model.ts
    ## DW = 1.2892, p-value = 0.0009445
    ## alternative hypothesis: true autocorrelation is greater than 0  
    
<br>  

â˜‘ï¸ `durbinWatsonTest`  

``` r
## ì”ì°¨ì˜ ìê¸°ìƒê´€ ê²€ì • : durbinWatsonTest
## 1ì°¨ ìê¸° ìƒê´€ ì™¸ì˜ ë‹¤ë¥¸ ìê¸°ìƒê´€ë„ í™•ì¸ì´ ê°€ëŠ¥í•¨

# install.packages('car')
library(car)
durbinWatsonTest(model.ts, max.lag = 1)
```

    ##  lag Autocorrelation D-W Statistic p-value
    ##    1       0.2977555      1.289232       0
    ##  Alternative hypothesis: rho != 0  
    
<br>  

â˜‘ï¸ `bgtest`  

``` r
## p-valueê°€ 0.05ë³´ë‹¤ ì‘ê¸° ë•Œë¬¸ì— ìê¸°ìƒê´€ì´ ì—†ë‹¤ëŠ” ê·€ë¬´ê°€ì„¤ì„ ê¸°ê°í•¨
bgtest(model.ts, order = 1)
```

    ## 
    ##  Breusch-Godfrey test for serial correlation of order up to 1
    ## 
    ## data:  model.ts
    ## LM test = 5.312, df = 1, p-value = 0.02118  
    
<br>  

â˜‘ï¸ `bgtest`   

``` r
bgtest(model.ts, order = 3)
```

    ## 
    ##  Breusch-Godfrey test for serial correlation of order up to 3
    ## 
    ## data:  model.ts
    ## LM test = 6.6573, df = 3, p-value = 0.08366  
    
<br>  
 


ì—¬ëŸ¬ ê²€ì • ìˆ˜ì¹˜ ë¹„êµ ê²°ê³¼, í•´ë‹¹ ëª¨ë¸ì€ ì‚¬ìš©í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤.  

ì¦‰, ì˜¤ì°¨í•­ì˜ ìê¸°ìƒê´€ ë¬¸ì œë¥¼ í•´ê²°í•´ì•¼ í•©ë‹ˆë‹¤. ëŒ€í‘œì ìœ¼ë¡œ ì°¨ë¶„ ë“±ì˜ ë°©ë²•ì´ ìˆê² ìŠµë‹ˆë‹¤!!  


<br>  

***  
